---
pdf_document: default
author: "FelipeN"
date: "04/02/2020"
output:
  html_document: default
  pdf_document: default
title: "SCCPT"
---


```{r}
library(tidyverse)
library(ggplot2)
library(reshape2)
```

Pode-se remover a linguagem científica e colocar a vírgula como separador dos decimais:

```{r}
options(OutDec = ",")
options (scipen=100)
```

Em seguida, se criou duas tabelas de dados segundo o tipo de pessoa: Física (SCCPF) e Jurídica(SCCPJ), ressaltando que os valores estão na unidade de R$(milhões):

```{r}
SCCPJ <- read.csv2("bcdata.sgs.25519.csv")
SCCPF <- read.csv2("bcdata.sgs.25518.csv")
```

Como ambas variáveis apresentam mesma data de início e fim, É possível as unir:

```{r}
SCCPT <- merge(SCCPJ,SCCPF, by=c("data"))
```

Optou-se por renomear as últimas colunas e em transformar os valores em "numeric":

```{r}
SCCPT <- rename(SCCPT, Valor.PJ = valor.x, Valor.PF = valor.y, Data = data)
SCCPT[,2] <- as.numeric(SCCPT[,2])
SCCPT[,3] <- as.numeric(SCCPT[,3])
```

Em seguida, se criou uma nova variÃ¡vel e um gráfico de barras para essas informações, mas sem alterar as variáveis anteriores:

```{r}
SCCPT2 <- melt(SCCPT,id.vars = "Data")
SCCPT2$Data <- as.Date(SCCPT2$Data, "%d/%m/%Y")
SCCPT2$Data <- as.numeric(format(SCCPT2$Data,"%Y"))
ggplot(SCCPT2, mapping=aes(x=SCCPT2$Data, y=SCCPT2$value)) + 
  geom_bar(mapping=aes(fill=SCCPT2$variable), stat="identity", position='dodge') + 
  scale_y_continuous(limits=c(0,100000), expand=c(0,0)) +
  scale_x_discrete(limits=c(2012,2013,2014,2015,2016,2017,2018), expand=c(0.05,0)) +
  theme(text=element_text(size=10)) +
  labs(title="Saldo de Crédito das Cooperativas para PJ e PF", x ="Ano", 
       y = "Valor aproximado em R$(milhões)", caption="Fonte: BCB/Depef", fill="Legenda") + 
  geom_text(aes(label=SCCPT2$value, group=SCCPT2$variable), 
            position = position_dodge(width = 0.95), vjust=-0.5, size=2.5) +
  scale_fill_brewer(palette="Dark2") 
```

Base de Dados:
BANCO CENTRAL DO BRASIL/DEPEF. Saldo de crÃ©dito das cooperativas para clientes pessoa física - total. Disponível em: <https://dadosabertos.bcb.gov.br/dataset/25518-saldo-de-credito-das-cooperativas-para-clientes-pessoa-fisica----total>. Acesso em: 26 jan. 2020.

BANCO CENTRAL DO BRASIL/DEPEF.Saldo de crÃ©dito das cooperativas para clientes pessoa juridica - total.Disponível em: <https://dadosabertos.bcb.gov.br/dataset/25519-saldo-de-credito-das-cooperativas-para-clientes-pessoa-juridica----total>. Acesso em 26 jan. 2020.


Pacotes usados:

Hadley Wickham (2007). Reshaping Data with the reshape Package. Journal of
Statistical Software, 21(12), 1-20. URL http://www.jstatsoft.org/v21/i12/.
  
H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York,
2016.

Hadley Wickham (2017). tidyverse: Easily Install and Load the 'Tidyverse'. R package
version 1.2.1. https://CRAN.R-project.org/package=tidyverse.

Linguagem R:
R Core Team (2019). R: A language and environment for statistical computing. R
Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.